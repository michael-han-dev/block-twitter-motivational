"use strict";(()=>{async function s(o,e){try{return(await chrome.storage.sync.get({[o]:e}))[o]}catch(r){return console.error(`Failed to get storage value for key ${o}:`,r),e}}async function n(o,e){try{await chrome.storage.sync.set({[o]:e})}catch(r){console.error(`Failed to set storage value for key ${o}:`,r)}}var t={SLOP_BLOCK_ENABLED:"slopBlockEnabled",DETECTION_COUNT:"detectionCount",USER_WHITELIST:"userWhitelist",BLUR_MODE:"blurMode"},i={[t.SLOP_BLOCK_ENABLED]:!1,[t.DETECTION_COUNT]:0,[t.USER_WHITELIST]:[],[t.BLUR_MODE]:!0};var a=class{constructor(){this.toggleSwitch=document.getElementById("toggleSwitch"),this.initialize()}async initialize(){await this.loadCurrentState(),this.setupEventListeners()}async loadCurrentState(){try{console.log("\u{1F50D} Popup loading current state from storage...");let e=await s(t.SLOP_BLOCK_ENABLED,i[t.SLOP_BLOCK_ENABLED]);console.log("\u{1F4CA} Current state from storage:",e),this.toggleSwitch.checked=e,console.log("\u2705 Toggle switch updated to:",e)}catch(e){console.error("\u274C Failed to load current state:",e)}}setupEventListeners(){this.toggleSwitch.addEventListener("change",async()=>{await this.handleToggleChange()})}async handleToggleChange(){try{let e=this.toggleSwitch.checked;console.log("\u{1F504} Toggle changed to:",e),console.log("\u{1F4BE} Saving new state to storage..."),await n(t.SLOP_BLOCK_ENABLED,e),console.log("\u2705 State saved to storage");try{console.log("\u{1F4E1} Notifying background script..."),await chrome.runtime.sendMessage({action:"stateChanged",enabled:e}),console.log("\u2705 Background script notified")}catch(r){console.log("\u26A0\uFE0F Background script not ready:",r)}}catch(e){console.error("\u274C Failed to handle toggle change:",e),this.toggleSwitch.checked=!this.toggleSwitch.checked}}isTwitterTab(e){return e?e.includes("twitter.com")||e.includes("x.com"):!1}};document.addEventListener("DOMContentLoaded",()=>{new a});})();
