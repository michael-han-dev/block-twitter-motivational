"use strict";(()=>{async function i(o,e){try{return(await chrome.storage.sync.get({[o]:e}))[o]}catch(t){return console.error(`Failed to get storage value for key ${o}:`,t),e}}async function n(o,e){try{await chrome.storage.sync.set({[o]:e})}catch(t){console.error(`Failed to set storage value for key ${o}:`,t)}}var r={SLOP_BLOCK_ENABLED:"slopBlockEnabled",DETECTION_COUNT:"detectionCount",USER_WHITELIST:"userWhitelist",BLUR_MODE:"blurMode"},c={[r.SLOP_BLOCK_ENABLED]:!1,[r.DETECTION_COUNT]:0,[r.USER_WHITELIST]:[],[r.BLUR_MODE]:!0};var s=class{constructor(){this.toggleSwitch=document.getElementById("toggleSwitch"),this.initialize()}async initialize(){await this.loadCurrentState(),this.setupEventListeners()}async loadCurrentState(){try{let e=await i(r.SLOP_BLOCK_ENABLED,c[r.SLOP_BLOCK_ENABLED]);this.toggleSwitch.checked=e}catch(e){console.error("Failed to load current state:",e)}}setupEventListeners(){this.toggleSwitch.addEventListener("change",async()=>{await this.handleToggleChange()})}async handleToggleChange(){var e;try{let t=this.toggleSwitch.checked;await n(r.SLOP_BLOCK_ENABLED,t);let a=await chrome.tabs.query({active:!0,currentWindow:!0});if((e=a[0])!=null&&e.id&&this.isTwitterTab(a[0].url))try{await chrome.tabs.sendMessage(a[0].id,{action:"toggleSlop",enabled:t})}catch{console.log("Content script not ready, will sync on next page load")}try{await chrome.runtime.sendMessage({action:"stateChanged",enabled:t})}catch{console.log("Background script not ready")}}catch(t){console.error("Failed to handle toggle change:",t),this.toggleSwitch.checked=!this.toggleSwitch.checked}}isTwitterTab(e){return e?e.includes("twitter.com")||e.includes("x.com"):!1}};document.addEventListener("DOMContentLoaded",()=>{new s});})();
