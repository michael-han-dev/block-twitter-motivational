"use strict";(()=>{var T=(e,t)=>()=>(e&&(t=e(e=0)),t);var J=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);async function F(e,t){try{return(await chrome.storage.sync.get({[e]:t}))[e]}catch{return t}}var g,M,H=T(()=>{"use strict";g={SLOP_BLOCK_ENABLED:"slopBlockEnabled",DETECTION_COUNT:"detectionCount",USER_WHITELIST:"userWhitelist",BLUR_MODE:"blurMode",OPENROUTER_API_KEY:"openRouterApiKey",CUSTOM_PROMPT:"customPrompt"},M={[g.SLOP_BLOCK_ENABLED]:!1,[g.DETECTION_COUNT]:0,[g.USER_WHITELIST]:[],[g.BLUR_MODE]:!0,[g.OPENROUTER_API_KEY]:"",[g.CUSTOM_PROMPT]:""}});function p(...e){}function O(){return Array.from(document.querySelectorAll('[data-testid="tweet"]')).filter(e=>{let t=e.closest("article");return t&&!t.hasAttribute("data-slop-processed")})}function P(e){var t,i,o,n;try{let s=Z(e);if(!s)return p("No text extracted for tweet:",e),null;X.textExtracted++;let a=e.querySelector('[data-testid="User-Name"]'),l=((t=a==null?void 0:a.textContent)==null?void 0:t.trim())||"unknown",d={replies:e.querySelector('[data-testid="reply"]'),retweets:e.querySelector('[data-testid="retweet"]'),likes:e.querySelector('[data-testid="like"]')},y={replies:S(((i=d.replies)==null?void 0:i.textContent)||"0"),retweets:S(((o=d.retweets)==null?void 0:o.textContent)||"0"),likes:S(((n=d.likes)==null?void 0:n.textContent)||"0")},c={text:s,username:l,engagement:y,element:e,timestamp:Date.now()};return p("Extracted tweet data:",{username:l,textLength:s.length,engagement:y,textPreview:s.substring(0,100)+"..."}),c}catch{return null}}function Z(e){var y,c;let t="",o=e.querySelector('[data-testid="tweetText"]');if((y=o==null?void 0:o.textContent)!=null&&y.trim())return t=o.textContent.trim(),p("Strategy 1 success:",t.substring(0,50)),t;let n=["[lang] span",".css-901oao span",'[dir="auto"] span'];for(let u of n){let f=e.querySelectorAll(u),A=Array.from(f).map(v=>{var k;return(k=v.textContent)==null?void 0:k.trim()}).filter(v=>v&&v.length>0);if(A.length>0&&(t=A.join(" ").trim(),t.length>10))return p("Strategy 2 success:",t.substring(0,50)),t}let s=e.querySelectorAll('[lang]:not([lang=""])');for(let u of Array.from(s)){let f=(c=u.textContent)==null?void 0:c.trim();f&&f.length>t.length&&(t=f)}if(t.trim().length>10)return p("Strategy 3 success:",t.substring(0,50)),t.trim();let a=e.querySelector('[data-testid="tweet"]')||e,d=ee(a).map(u=>{var f;return(f=u.textContent)==null?void 0:f.trim()}).filter(u=>u&&u.length>3).filter(u=>!te(u));return d.length>0?(t=d.join(" ").trim(),p("Strategy 4 success:",t.substring(0,50)),t):(p("All strategies failed for element:",e),"")}function ee(e){let t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:n=>{var d;let s=n.parentElement;if(!s)return NodeFilter.FILTER_REJECT;let a=s.tagName.toLowerCase();if(["script","style","svg"].includes(a))return NodeFilter.FILTER_REJECT;let l=(d=n.textContent)==null?void 0:d.trim();return!l||l.length<3?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),o;for(;o=i.nextNode();)t.push(o);return t}function te(e){return[/^\d+[hms]$/,/^Â·$/,/^@/,/^Show this thread$/,/^Replying to/,/^Quote Tweet$/,/^Retweet$/,/^\d+$/,/^Show replies$/,/^More$/].some(i=>i.test(e.trim()))}function S(e){if(!e)return 0;let t=e.replace(/[^\d.KMkm]/g,""),i=parseFloat(t);return isNaN(i)?0:t.toLowerCase().includes("k")?Math.round(i*1e3):t.toLowerCase().includes("m")?Math.round(i*1e6):Math.round(i)}function _(e){if(e.hasAttribute("data-slop-collapsed"))return;e.querySelectorAll(".slop-collapse-header").forEach(n=>n.remove());let i=e.innerHTML;e.setAttribute("data-original-content",i);let o=document.createElement("div");o.className="slop-collapsed",o.innerHTML=`
    <div class="slop-collapsed-header">
      <span class="slop-collapsed-text">AI-generated content hidden</span>
      <span class="slop-expand-icon">\u25BC</span>
    </div>
  `,o.addEventListener("mouseenter",()=>{o.style.backgroundColor="rgb(239, 243, 244)"}),o.addEventListener("mouseleave",()=>{o.style.backgroundColor="rgb(247, 249, 250)"}),o.addEventListener("click",()=>{oe(e)}),e.innerHTML="",e.appendChild(o),e.setAttribute("data-slop-collapsed","true"),e.style.display="block"}function oe(e){if(!e.hasAttribute("data-slop-collapsed"))return;let t=e.getAttribute("data-original-content");t&&(e.innerHTML=t),e.querySelectorAll(".slop-collapse-header").forEach(n=>n.remove());let o=document.createElement("div");o.className="slop-collapse-header",o.innerHTML=`
    <div class="slop-collapse-button">
      <span class="slop-collapse-text">\u{1F916} Hide AI content</span>
      <span class="slop-collapse-icon">\u25B2</span>
    </div>
  `,o.addEventListener("mouseenter",()=>{o.style.backgroundColor="rgb(239, 243, 244)"}),o.addEventListener("mouseleave",()=>{o.style.backgroundColor="rgb(247, 249, 250)"}),o.addEventListener("click",n=>{n.stopPropagation(),_(e)}),e.insertBefore(o,e.firstChild),e.removeAttribute("data-slop-collapsed"),e.removeAttribute("data-original-content")}function I(e,t){$(e)}function R(e){if(U(e),e.classList.remove("slop-blurred","slop-hidden","slop-collapsed"),e.querySelectorAll(".slop-collapse-header").forEach(o=>o.remove()),e.querySelectorAll(".slop-hide-again-header").forEach(o=>o.remove()),e.classList.remove("slop-blurred","slop-hidden","slop-collapsed","slop-debug","slop-debug-detected","slop-debug-processed"),e.style.filter="",e.style.opacity="",e.style.pointerEvents="",e.style.userSelect="",e.style.border="",e.style.borderRadius="",e.style.outline="",e.style.backgroundColor="",e.style.display="",e.hasAttribute("data-slop-collapsed")){let o=e.getAttribute("data-original-content");o&&(e.innerHTML=o,e.removeAttribute("data-original-content")),e.removeAttribute("data-slop-collapsed")}e.removeAttribute("data-slop-username-only"),e.removeAttribute("data-slop-original-content")}function D(e,t){var i,o;N&&(e.hasAttribute("data-slop-processed")||(t?(e.classList.add("slop-debug-detected"),p("\u{1F534} SLOP DETECTED:",{element:e,text:(i=e.textContent)==null?void 0:i.substring(0,100)})):(e.classList.add("slop-debug-processed"),p("\u{1F7E2} Clean tweet processed:",{element:e,text:(o=e.textContent)==null?void 0:o.substring(0,50)})),e.setAttribute("data-slop-processed","true")))}function $(e){if(e.hasAttribute("data-slop-username-only"))return;let t=ie(e);if(!t.displayName&&!t.handle){p("Could not extract username, falling back to collapse"),_(e);return}e.querySelectorAll(".slop-hide-again-header").forEach(a=>a.remove());let o=e.innerHTML;e.setAttribute("data-slop-original-content",o);let n=document.createElement("div");n.className="slop-username-display",n.style.cssText=`
    background: rgb(247, 249, 250);
    border: 1px solid rgb(207, 217, 222);
    border-radius: 16px;
    padding: 16px;
    margin: 2px 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  `,n.innerHTML=`
    <div style="display: flex; flex-direction: column; gap: 8px;">
      <div style="display: flex; align-items: center; gap: 8px;">
        <span style="font-weight: 700; color: rgb(15, 20, 25); font-size: 15px;">${t.displayName||"User"}</span>
        ${t.handle?`<span style="color: rgb(83, 100, 113); font-size: 15px;">@${t.handle}</span>`:""}
      </div>
      <div style="color: rgb(83, 100, 113); font-size: 15px; margin: 4px 0;">
        Content hidden by Slop Block
      </div>
      <button class="slop-show-content" style="
        background: rgb(29, 161, 242);
        color: white;
        border: none;
        border-radius: 20px;
        padding: 8px 16px;
        font-size: 14px;
        font-weight: 700;
        cursor: pointer;
        transition: background-color 0.2s ease;
        align-self: flex-start;
      ">Show</button>
    </div>
  `,n.addEventListener("mouseenter",()=>{n.style.backgroundColor="rgb(239, 243, 244)"}),n.addEventListener("mouseleave",()=>{n.style.backgroundColor="rgb(247, 249, 250)"});let s=n.querySelector(".slop-show-content");s==null||s.addEventListener("click",a=>{a.stopPropagation(),U(e)}),e.innerHTML="",e.appendChild(n),e.setAttribute("data-slop-username-only","true"),e.style.display="block"}function ie(e){var n;let t=e.querySelector('[data-testid="User-Name"]'),i=null,o=null;if(t){let s=t.querySelectorAll("span");for(let a of Array.from(s)){let l=(n=a.textContent)==null?void 0:n.trim();l&&(l.startsWith("@")?o=l.substring(1):!i&&!l.includes("@")&&(i=l))}}return{displayName:i,handle:o}}function U(e){if(!e.hasAttribute("data-slop-username-only"))return;let t=e.getAttribute("data-slop-original-content");t&&(e.innerHTML=t),e.querySelectorAll(".slop-hide-again-header").forEach(n=>n.remove());let o=document.createElement("div");o.className="slop-hide-again-header",o.style.cssText=`
    background: rgb(247, 249, 250);
    border: 1px solid rgb(207, 217, 222);
    border-radius: 12px;
    padding: 8px 12px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  `,o.innerHTML=`
    <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
      <span style="color: rgb(83, 100, 113); font-size: 13px; font-weight: 400;">\u{1F916} Hide AI content again</span>
      <span style="color: rgb(83, 100, 113); font-size: 12px; margin-left: 8px; transition: transform 0.2s ease;">\u25B2</span>
    </div>
  `,o.addEventListener("mouseenter",()=>{o.style.backgroundColor="rgb(239, 243, 244)"}),o.addEventListener("mouseleave",()=>{o.style.backgroundColor="rgb(247, 249, 250)"}),o.addEventListener("click",n=>{n.stopPropagation(),$(e)}),e.insertBefore(o,e.firstChild),e.removeAttribute("data-slop-username-only"),e.removeAttribute("data-slop-original-content")}var N,X,q=T(()=>{"use strict";N=window.DEBUG_SLOP_DETECTION||!1;X={totalTweets:0,textExtracted:0,slopDetected:0}});function z(e){let t=e.text.toLowerCase(),i=[],o=0;for(let c of ne)c.test(t)&&(o+=.3,i.push(`Matches pattern: ${c.source}`));let n=0;for(let c of se)t.includes(c.toLowerCase())&&n++;n>=3&&(o+=.2,i.push(`High slop keyword density: ${n} keywords`));let s=(t.match(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu)||[]).length,a=t.replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu,"").length;if(a>0){let c=s/a;c>.1&&(o+=.15,i.push(`High emoji to text ratio: ${(c*100).toFixed(1)}%`))}return s>5&&(o+=.1,i.push(`Excessive emojis: ${s}`)),(t.includes("ai")||t.includes("artificial intelligence")||t.includes("chatgpt")||t.includes("openai"))&&(/human|person|people|individual|someone|anyone/.test(t)||(o+=.2,i.push("Mentions AI without human context"))),t.match(/^(here's|this is|today|remember)/i)&&t.match(/(success|mindset|growth)$/i)&&(o+=.15,i.push("Generic motivational structure")),(e.engagement.likes+e.engagement.retweets)/Math.max(1,e.text.length)>10&&e.text.length<50&&(o+=.1,i.push("High engagement with low content quality")),/\d+\.\s|\d+\)\s/.test(t)&&t.split(/\d+[.\)]\s/).length>3&&(o+=.1,i.push("List format (common in slop)")),(t.match(/[A-Z]/g)||[]).length/t.length>.3&&(o+=.1,i.push("Excessive capitalization")),(t.match(/\d+/g)||[]).length>3&&(o+=.05,i.push("Number-heavy content")),{isSlop:o>.25,confidence:Math.min(o,1),reasons:i}}var ne,se,B=T(()=>{"use strict";ne=[/if you're not (growing|building|scaling|optimizing)/i,/here's what I learned/i,/\d+ things? (that|I wish|nobody tells you)/i,/stop doing this.*start doing this/i,/the \d+ (secrets?|steps?|ways?)/i,/why \d+% of people fail/i,/most people don't (know|realize|understand)/i,/I turned \$\d+ into \$\d+/i,/buy my course/i,/link in bio/i,/dm me for/i,/limited time offer/i,/exclusive access/i,/join my/i,/free training/i,/webinar/i,/masterclass/i,/coaching/i,/mentorship/i,/blueprint/i,/system that made me/i,/secrets? they don't want you to know/i,/\$\d+k?\/month/i,/six[\s-]?figure/i,/seven[\s-]?figure/i,/passive income/i,/financial freedom/i,/quit my job/i,/fire your boss/i,/work from home/i,/laptop lifestyle/i,/location independent/i,/digital nomad/i,/escape the 9[\s-]?to[\s-]?5/i,/hustle harder/i,/grind never stops/i,/sleep is for the weak/i,/no days off/i,/rise and grind/i,/beast mode/i,/millionaire mindset/i,/entrepreneur life/i,/CEO mindset/i,/winner mentality/i,/alpha (male|mindset)/i,/sigma (male|grindset)/i,/that grindset/i,/believe in yourself/i,/follow your dreams/i,/you miss 100% of the shots/i,/success is a choice/i,/mindset is everything/i,/you are your only limit/i,/dream big/i,/stay positive/i,/good vibes only/i,/manifest your destiny/i,/law of attraction/i,/positive energy/i,/trust the process/i,/everything happens for a reason/i,/be grateful/i,/blessed and grateful/i,/counting my blessings/i,/gratitude changes everything/i,/attitude of gratitude/i,/focus on solutions not problems/i,/problems are opportunities/i,/failure is just feedback/i,/there's no such thing as failure/i,/every setback is a setup for a comeback/i,/if you do (this|these) \d+ things/i,/simple formula/i,/proven system/i,/step[\s-]?by[\s-]?step (guide|process)/i,/foolproof method/i,/ultimate guide/i,/complete blueprint/i,/secret formula/i,/exact strategy/i,/winning formula/i,/game[\s-]?changing/i,/you won't believe what happened next/i,/this will blow your mind/i,/most people don't know this/i,/here's the thing/i,/let that sink in/i,/read that again/i,/this is important/i,/pay attention/i,/actionable (tips|advice|strategies)/i,/practical advice/i,/real[\s-]?world application/i,/implement (this|these) today/i,/start doing this now/i,/game[\s-]?changer/i,/life[\s-]?changing/i,/overnight success/i,/transformed my life in \d+ days/i,/went from zero to/i,/\d+ to \d+ in \d+ months/i,/before and after/i,/complete transformation/i,/made \$\d+k? (today|this month|last month)/i,/revenue/i,/profit margin/i,/roi of \d+%/i,/\d+x return/i,/thread/i,/ð§µ/i,/here's what you need to know/i,/unpopular opinion/i,/controversial take/i,/hot take/i,/let's normalize/i,/normalize this/i,/this is your reminder/i,/friendly reminder/i,/daily reminder/i,/motivation monday/i,/wisdom wednesday/i,/thoughtful thursday/i,/feel[\s-]?good friday/i],se=["mindset","hustle","grind","manifest","abundance","entrepreneur","success","motivation","inspiration","goals","dreams","vision","purpose","passion","breakthrough","transformation","journey","growth","evolve","elevate","optimize","maximize","unlock","unleash","potential","power","energy","vibration","frequency","alignment","authentic","genuine","real","truth","wisdom","knowledge","insight","awareness","consciousness","awakening"]});var ge=J(()=>{H();q();B();var E=!1,b=[],w=!1,h=null,m=null,L=null;function r(...e){}function C(){return document.querySelectorAll('[data-testid="tweet"]').length>0}function Q(){m&&clearInterval(m),m=window.setInterval(()=>{r("\u23F3 Checking if Twitter is loaded..."),C()&&(r("\u2705 Twitter loaded, starting slop detection"),clearInterval(m),m=null,E&&G())},1e3)}function x(...e){window.location.hash.includes("slopDebug")}function W(e){b.includes(e)||b.push(e),w||re()}function re(){w||(w=!0,setTimeout(()=>{ae(),w=!1},200))}function ae(){if(b.length===0)return;r(`\u{1F4E6} Processing queue of ${b.length} elements`);let e=[...b];b=[],e.forEach(t=>{document.contains(t)&&le(t)})}function G(){if(!E){r("\u274C Slop detection disabled, skipping initialization");return}r("\u{1F680} Initializing slop detection system..."),ce(),setTimeout(()=>{V()},500)}function V(){r("\u{1F50D} Scanning for tweets...");let e=O();r(`\u{1F4CA} Found ${e.length} unprocessed tweets`),e.forEach(t=>{W(t)})}function le(e){var t;try{let i=P(e);if(!i){x("\u274C Could not extract tweet data from element:",e);return}x("\u{1F4DD} Processing tweet:",{username:i.username,textLength:i.text.length,textPreview:i.text.substring(0,100)});let o=z(i);x("\u{1F3AF} Analysis result:",{isSlop:o.isSlop,confidence:o.confidence,reasons:o.reasons}),o.isSlop&&(r(`\u{1F6AB} SLOP DETECTED (confidence: ${(o.confidence*100).toFixed(1)}%):`,{username:i.username,reasons:o.reasons,text:i.text.substring(0,100)+"..."}),I(i.element,"hide")),D(i.element,o.isSlop),(t=i.element.closest("article"))==null||t.setAttribute("data-slop-processed","true")}catch{}}function ce(){h&&h.disconnect(),h=new MutationObserver(e=>{if(!E)return;let t=[];e.forEach(i=>{i.addedNodes.forEach(o=>{if(o.nodeType===Node.ELEMENT_NODE){let n=o,s=n.querySelectorAll?Array.from(n.querySelectorAll('[data-testid="tweet"]')):[];n.matches&&n.matches('[data-testid="tweet"]')&&s.push(n),t.push(...s)}})}),t.length>0&&(x(`\u{1F440} Observer detected ${t.length} new tweet(s)`),t.forEach(i=>{W(i)}))}),h.observe(document.body,{childList:!0,subtree:!0,attributes:!1}),r("\u{1F441}\uFE0F MutationObserver started for dynamic content detection")}function de(){h&&(h.disconnect(),h=null,r("\u{1F6D1} MutationObserver stopped"))}function ue(){r("\u{1F9F9} Cleaning up slop effects...");let e=document.querySelectorAll('[data-slop-processed="true"]');e.forEach(t=>{let i=t;R(i),i.removeAttribute("data-slop-processed")}),r(`\u2705 Cleaned up ${e.length} processed tweets`)}async function Y(e){let t=E;E=e,r(`\u{1F504} State changed: ${t} \u2192 ${e}`),e&&!t?C()?G():Q():!e&&t&&(de(),ue(),m&&(clearInterval(m),m=null))}chrome.runtime.onMessage.addListener((e,t,i)=>{try{e.action==="stateChanged"&&(Y(e.enabled),i({success:!0}))}catch(o){i({success:!1,error:String(o)})}return!0});function pe(){r("\u{1F9ED} Navigation detected, reinitializing..."),L&&clearTimeout(L),L=window.setTimeout(()=>{E&&V()},1e3)}var j=location.href;new MutationObserver(()=>{let e=location.href;e!==j&&(j=e,pe())}).observe(document,{subtree:!0,childList:!0});async function K(){try{r("\u{1F527} Initializing content script...");let e=await F(g.SLOP_BLOCK_ENABLED,M[g.SLOP_BLOCK_ENABLED]);r(`\u{1F4CA} Initial state from storage: ${e}`),await Y(e),C()||(r("\u23F3 Twitter not loaded yet, starting load check..."),Q()),r("\u2705 Content script initialization complete")}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",K):K()});ge();})();
